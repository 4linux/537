funcionarios = spark.read.csv("gs://roberto_farias_database/export_usuarios.csv")
column_list = ['id','nome','departamento','salario','email','senha','cadastro']
funcionarios = funcionarios.toDF(*column_list)

funcionarios.printSchema()
funcionarios.show()
funcionarios.count()
funcionarios.take(5)

funcionarios.select("Nome").show()
funcionarios.select("Nome", "Departamento").show()
funcionarios.groupBy("departamento").count().show()

funcionarios.createOrReplaceTempView("funcionarios")
sqlPROJETOS = spark.sql("SELECT * FROM funcionarios WHERE Departamento = 'Projetos'")
sqlPROJETOS.show()

sqlSALARIOS = spark.sql("SELECT * FROM funcionarios WHERE Salario > 5000").show()

sqlSALARIOS = spark.sql("SELECT * FROM funcionarios WHERE Salario > 5000").write.mode('Overwrite').csv('gs://roberto_farias_database/funcionarios_output_csv')

sqlSALARIOS = spark.sql("SELECT * FROM funcionarios WHERE Salario > 5000").write.mode('Overwrite').json('gs://roberto_farias_database/funcionarios_Output_json')

